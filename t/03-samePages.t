use Test::More;
use Biblio::Citation::Compare 'samePages';
use utf8; # for the dashes

# This is not perfectly systematic and could perhaps be improved. -RM

my @samePagesYes = (
  ["100-150","100-150"],
  ["100-150","100-50"],
  ["100-150","100 - 150"],
  ["100-150","100 - 50"],
  ["100-150","100 50"],
  ["100 -150","100-50"],
  ["100- 150","100-50"],
  ["100 -150","100 50"],
  ["100- 150","100 50"],
  ["100–150","100 50"],
  ["100 – 150","100 50"],
  ["100–150","100-50"],
  ["p 100–150","100-50"],
  ["pp.100–150","100-50"],
  ["p.100– p. 150","100-50"],
  ["100 – 150","100-50"],
  ["100 &ndash; 150","100 50"],
  ["100 &ndash; 150","100 50"],
  ["100 &ndash; 150","100-50"],
  ["100 &ndash; 150","100-50"],
  ["100&#x2013;150","100-150"],
  ["100&#x2013;150","100-50"],
  ["100&#x2013;150","100 150"],
  ["100&#x2013;150","100 50"],
  ["100&#8211;150","100 50"],
  ["100&#8211;150","100 50"],
  ["100&#8211;150","100-50"],
  ["100&#8211;150","100-50"],
  ["F100-F150","100-50"],
  ["FF100-FF150","100 - 50"],
  ["F100-150","100 50"],
  ["f100 -150","f100 f50"],
  ["100 - 150","ff100 ff50"],
  ["100 - 150","100 50"],
  ["cci-ccvi", "201-206"],
  ["cci-ccvi", "202-206"],
  ["cci-ccvi", "201-207"],
  ["cci-ccvi", "ccii ccvi"],
  ["cci-ccvi", "ccii - ccvi"],
  #broken in same way:
  ["150-23","150-23"]
  
);

my @samePagesYesFirstSufficient = (
  ["100-150","100"],
  ["101","100 - 50"],
  ["100-150","101"],
  ["100 -150","100 50"],
  ["100 - 150","100"],
  ["100","100 - 50"],
);

my @samePagesNo = (
  ["1-20", "3-30"],
  ["100-150","100-152"],
  ["100-150","100 - 152"],
  ["100-150","100 152"],
  ["100 -150","100 152"],
  ["100 - 150","100 152"],
  ["100 - 150","100 152"],
  ["103-150","100-151"],
  ["98-150","100 - 150"],
  ["100-150","100 152"],
  ["100 -150","100 152"],
  ["100 - 150","100–152"],
  ["100-150","100–152"],
  ["100-150","100 - 52"],
  ["100-150","100 52"],
  ["100 -150","100 52"],
  ["100 - 150","100 52"],
  ["103-150","100-51"],
  ["98-150","100 - 150"],
  ["100-150","100 152"],
  ["100 -150","100 52"],
  ["100 - 150","100 152"],
  ["D100 - F150","100-150"],
  ['ccvi-ccc', 'ccviii-ccc'],
  ['ccvi-ccc', 'ccvi-cccv'],
  # Some actual db values...
  ['Quesnel, Michel -Michel GOURGUES', '1-10'],
  ['Boyle, John F.-Peter LOMBARD , T', '1'],
  ['Allard, Maxime-Pierre GISEL (éd.', 'i'],
  ['Roy, Louis-Medard KEHL , « Et Di', 'iv'],
  ['Allard, Maxime-Jérôme ROUSSE-LAC', 'John Smith'],
  ['Gilbert, André-Pierrot LAMBERT, ', 'Smith, John'],
);

my @samePagesNoStrict = (
  ["cci-ccvi", "201-206"],
  ["cci-ccvi", "202-206"],
  ["cci-ccvi", "201-207"],
);

ok(samePages($_->[0], $_->[1]), "$_->[0] == $_->[1]") for @samePagesYes;
ok(samePages($_->[0], $_->[1], match_first_sufficient => 1), "msf: $_->[0] == $_->[1]") for @samePagesYesFirstSufficient;
ok(!samePages($_->[0], $_->[1]), "$_->[0] != $_->[1]") for @samePagesNo;
ok(!samePages($_->[0], $_->[1], strict => 1), "strict: $_->[0] != $_->[1]") for @samePagesNoStrict;